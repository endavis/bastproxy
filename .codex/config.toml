# Codex CLI Configuration
# Location: ~/.codex/config.toml or project-specific .codex/config.toml
#
# This configuration whitelists common development commands for Python projects
# using uv, doit, git, and GitHub CLI.

# Default approval policy
approval_policy = "untrusted"  # Prompt before running untrusted commands

# Whitelist standard development tools
[[approval_policy]]
type = "command"
pattern = "^(git|gh|uv|doit|ls|cat|tree|find|grep|wc|mkdir|python|pytest|ruff|mypy)\\b"
action = "allow"
reason = "Standard development and version control tools"

# Allow specific git operations
[[approval_policy]]
type = "command"
pattern = "^git\\s+(status|diff|log|add|commit|push|pull|fetch|checkout|branch|merge|stash|reset|rebase|remote)"
action = "allow"
reason = "Common git operations"

# Allow GitHub CLI operations
[[approval_policy]]
type = "command"
pattern = "^gh\\s+(auth|pr|issue|run|api)"
action = "allow"
reason = "GitHub CLI operations"

# Allow uv package management
[[approval_policy]]
type = "command"
pattern = "^uv\\s+(pip|venv|build|publish|run|sync)"
action = "allow"
reason = "UV package manager operations"

# Allow doit task automation
[[approval_policy]]
type = "command"
pattern = "^doit\\s+(list|test|coverage|lint|format|check|build|cleanup)"
action = "allow"
reason = "Doit task automation"

# Shell environment policy - whitelist safe environment variables
[shell_env_policy]
include_only = [
    "PATH",
    "HOME",
    "USER",
    "UV_CACHE_DIR",
    "VIRTUAL_ENV",
    "PYTHONPATH",
]
exclude = [
    "*_API_KEY",
    "*_SECRET",
    "*_TOKEN",
    "PASSWORD",
    "PYPI_TOKEN",
    "CODECOV_TOKEN",
]

# Sandbox mode (optional - set to false for local development)
# sandbox_mode = false

# Network access policy
# network_access = "prompt"  # Options: "allow", "deny", "prompt"
