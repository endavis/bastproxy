# direnv configuration for this project
# This file contains project defaults and is version-controlled
# For personal overrides, create .envrc.local (git-ignored)

# Activate virtual environment (if it exists)
# Run 'uv sync --all-extras --dev' to create the virtual environment
if [ -d .venv ]; then
  source .venv/bin/activate
else
  echo "âš ï¸  Virtual environment not found. Run: uv sync --all-extras --dev"
fi

# Cache directories (all point to tmp/)
export UV_CACHE_DIR=${UV_CACHE_DIR:-"$(pwd)/tmp/.uv_cache"}
export RUFF_CACHE_DIR=${RUFF_CACHE_DIR:-"$(pwd)/tmp/.ruff_cache"}
export MYPY_CACHE_DIR=${MYPY_CACHE_DIR:-"$(pwd)/tmp/.mypy_cache"}
export COVERAGE_FILE=${COVERAGE_FILE:-"$(pwd)/tmp/.coverage"}
export PRE_COMMIT_HOME=${PRE_COMMIT_HOME:-"$(pwd)/tmp/.pre-commit"}

# Add local bin to PATH
export PATH="$PWD/.venv/bin:$PATH"

# Project-specific environment variables
# Uncomment and customize as needed:
# export DEBUG=${DEBUG:-false}
# export LOG_LEVEL=${LOG_LEVEL:-INFO}

# Load user-specific settings from .envrc.local (git-ignored)
# This is where you put personal overrides and credentials
if [ -f .envrc.local ]; then
  source_env .envrc.local
fi
watch_file .envrc.local

# Show loaded configuration
echo "ðŸ”§ Project environment loaded"
echo "   Python: $(python --version 2>&1)"
echo "   Caches: tmp/ (UV, Ruff, Mypy, Coverage, Pre-commit)"

# Helpful warnings
if [ ! -f .envrc.local ]; then
  echo "ðŸ’¡ Tip: Create .envrc.local for personal settings (API keys, debug flags, etc.)"
fi
